(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{OqcB:function(n,t,e){"use strict";e.r(t);var r=e("keVe"),i=e("bb6g"),l=e("TT6o"),a=e("zvoD"),s=e("dpyN"),u=e("ODRz"),c=function(){function n(n){this.player=n}return n.prototype.initialize=function(n){this.analyser=n,this.analyser.fftSize=256,this.bufferLength=this.analyser.frequencyBinCount,this.frequencyBarGraphs.barWidth=this.canvasElement.width/this.bufferLength*2.5,this.dataArray=new Uint8Array(this.bufferLength)},n.prototype.ngOnInit=function(){var n=this;this.canvasElement=this.canvasElementRef.nativeElement,this.canvasElement.width=window.innerWidth,this.canvasElement.height=window.innerHeight,this.player.analyserChange.pipe(Object(a.a)(function(n){return!!n})).subscribe(function(t){n.initialize(t),n.drawFrequencyBarGraphs()}),this.frequencyBarGraphs={fullWidth:this.canvasElement.width,fullHeight:this.canvasElement.height,barWidth:0,barHeight:0,x:0,ctx:this.canvasElement.getContext("2d")},this.player.songChange.pipe(Object(s.a)(),Object(a.a)(function(n){return!!n})).subscribe(function(t){n.generateLyric(t.lyric)}),this.player.progressTime.pipe(Object(a.a)(function(n){return!!n.original})).subscribe(function(t){for(var e=t.original,r=0,i=0;i<n.lyrics.length;i++)e>n.lyrics[i][0]-1&&(r=i);n.currentIndex=r})},n.prototype.drawFrequencyBarGraphs=function(){this.frequencyBarGraphs.x=0,this.analyser.getByteFrequencyData(this.dataArray),this.frequencyBarGraphs.ctx.clearRect(0,0,this.frequencyBarGraphs.fullWidth,this.frequencyBarGraphs.fullHeight);for(var n=0;n<this.bufferLength;n++)this.frequencyBarGraphs.barHeight=this.dataArray[n],this.frequencyBarGraphs.ctx.fillStyle="rgb("+(this.frequencyBarGraphs.barHeight+n/this.bufferLength*150)+", "+n/this.bufferLength*20+", 10)",this.frequencyBarGraphs.ctx.fillRect(this.frequencyBarGraphs.x,this.frequencyBarGraphs.fullHeight-this.frequencyBarGraphs.barHeight,this.frequencyBarGraphs.barWidth,this.frequencyBarGraphs.barHeight),this.frequencyBarGraphs.x+=this.frequencyBarGraphs.barWidth+1;requestAnimationFrame(this.drawFrequencyBarGraphs.bind(this))},n.prototype.generateLyric=function(n){void 0===n&&(n="");var t=decodeURIComponent(escape(window.atob(n||"")));this.lyrics=function(n){for(var e=t.split("\n"),r=/\[\d{2}:\d{2}.\d{2}\]/g,i=[];!r.test(e[0]);)e=e.slice(1);0===e[e.length-1].length&&e.pop();for(var l=0,a=e;l<a.length;l++){var s=a[l],u=s.indexOf("]"),c=s.substring(0,u+1),o=s.substring(u+1),h=c.substring(1,c.length-2).split(":");i.push([60*parseInt(h[0],10)+parseFloat(h[1]),o])}return i.sort(function(n,t){return n[0]-t[0]}),i}()},n.prototype.ngOnDestroy=function(){},i.b([Object(u.a)()],n)}(),o=function(){return function(){}}(),h=e("fYis"),p=e("TOqr"),f=r.ob({encapsulation:0,styles:[[".lyric-wrapper[_ngcontent-%COMP%]{position:absolute;width:650px;height:65%;top:100px;left:50%;-webkit-transform:translateX(-325px);transform:translateX(-325px);overflow:hidden;z-index:10}.lyric-wrapper[_ngcontent-%COMP%]   .lyric-inner[_ngcontent-%COMP%]{transition:top .3s ease-out;-webkit-transform-origin:0 0 0;transform-origin:0 0 0;position:absolute;left:10px;right:10px;top:280px}.lyric-wrapper[_ngcontent-%COMP%]   .lyric-inner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{overflow:hidden;height:42px;line-height:42px;text-overflow:ellipsis;white-space:nowrap;font-size:16px;color:rgba(225,225,225,.6);text-align:center;margin:0}.lyric-wrapper[_ngcontent-%COMP%]   .lyric-inner[_ngcontent-%COMP%]   p.active[_ngcontent-%COMP%]{font-size:20px;color:#fff}canvas[_ngcontent-%COMP%]{position:fixed;left:0;top:0;width:100vw;height:100vh}"]],data:{}});function b(n){return r.Hb(0,[(n()(),r.qb(0,0,null,null,4,"p",[],null,null,null,null,null)),r.Cb(512,null,p.r,p.s,[r.s,r.t,r.k,r.D]),r.pb(2,278528,null,0,p.i,[p.r],{ngClass:[0,"ngClass"]},null),r.Bb(3,{active:0}),(n()(),r.Fb(4,null,["",""]))],function(n,t){var e=n(t,3,0,t.context.index===t.component.currentIndex);n(t,2,0,e)},function(n,t){n(t,4,0,t.context.$implicit[1])})}function y(n){return r.Hb(0,[r.Db(402653184,1,{canvasElementRef:0}),(n()(),r.qb(1,0,null,null,3,"div",[["class","lyric-wrapper"]],null,null,null,null,null)),(n()(),r.qb(2,0,null,null,2,"div",[["class","lyric-inner"]],[[4,"top","px"]],null,null,null,null)),(n()(),r.fb(16777216,null,null,1,null,b)),r.pb(4,278528,null,0,p.j,[r.O,r.L,r.s],{ngForOf:[0,"ngForOf"]},null),(n()(),r.qb(5,0,[[1,0],["canvas",1]],null,0,"canvas",[],null,null,null,null,null))],function(n,t){n(t,4,0,t.component.lyrics)},function(n,t){n(t,2,0,300-42*(t.component.currentIndex+1))})}function g(n){return r.Hb(0,[(n()(),r.qb(0,0,null,null,1,"biger-home",[],null,null,null,y,f)),r.pb(1,245760,null,0,c,[l.a],null,null)],function(n,t){n(t,1,0)},null)}var d=r.mb("biger-home",c,g,{},{},[]),v=e("X+PR");e.d(t,"MusicModuleNgFactory",function(){return w});var w=r.nb(o,[],function(n){return r.xb([r.yb(512,r.j,r.ab,[[8,[h.a,d]],[3,r.j],r.x]),r.yb(4608,p.m,p.l,[r.u,[2,p.u]]),r.yb(1073742336,p.c,p.c,[]),r.yb(1073742336,v.l,v.l,[[2,v.q],[2,v.k]]),r.yb(1073742336,o,o,[]),r.yb(1024,v.i,function(){return[[{path:"",component:c}]]},[])])})}}]);
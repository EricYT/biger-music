(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{OqcB:function(n,t,e){"use strict";e.r(t);var r=e("Mlb/"),i=e("bb6g"),l=e("TT6o"),a=e("70cc"),s=e("S5zL"),c=e("ODRz");let h=class{constructor(n){this.player=n}initialize(n){this.analyser=n,this.analyser.fftSize=256,this.bufferLength=this.analyser.frequencyBinCount,this.frequencyBarGraphs.barWidth=this.canvasElement.width/this.bufferLength*2.5,this.dataArray=new Uint8Array(this.bufferLength)}ngOnInit(){this.canvasElement=this.canvasElementRef.nativeElement,this.canvasElement.width=window.innerWidth,this.canvasElement.height=window.innerHeight,this.player.analyserChange.pipe(Object(a.a)(n=>!!n)).subscribe(n=>{this.initialize(n),this.drawFrequencyBarGraphs()}),this.frequencyBarGraphs={fullWidth:this.canvasElement.width,fullHeight:this.canvasElement.height,barWidth:0,barHeight:0,x:0,ctx:this.canvasElement.getContext("2d")},this.player.songChange.pipe(Object(s.a)(),Object(a.a)(n=>!!n)).subscribe(n=>{this.generateLyric(n.lyric)}),this.player.progressTime.pipe(Object(a.a)(n=>!!n.original)).subscribe(({original:n})=>{let t=0;for(let e=0;e<this.lyrics.length;e++)n>this.lyrics[e][0]-1&&(t=e);this.currentIndex=t})}drawFrequencyBarGraphs(){this.frequencyBarGraphs.x=0,this.analyser.getByteFrequencyData(this.dataArray),this.frequencyBarGraphs.ctx.clearRect(0,0,this.frequencyBarGraphs.fullWidth,this.frequencyBarGraphs.fullHeight);for(let n=0;n<this.bufferLength;n++){this.frequencyBarGraphs.barHeight=this.dataArray[n];const t=this.frequencyBarGraphs.barHeight+n/this.bufferLength*150,e=n/this.bufferLength*100,r=50;this.frequencyBarGraphs.ctx.fillStyle=`rgb(${t}, ${e}, ${r})`,this.frequencyBarGraphs.ctx.fillRect(this.frequencyBarGraphs.x,this.frequencyBarGraphs.fullHeight-this.frequencyBarGraphs.barHeight,this.frequencyBarGraphs.barWidth,this.frequencyBarGraphs.barHeight),this.frequencyBarGraphs.x+=this.frequencyBarGraphs.barWidth+1}requestAnimationFrame(this.drawFrequencyBarGraphs.bind(this))}generateLyric(n=""){const t=decodeURIComponent(escape(window.atob(n||"")));this.lyrics=function(n){const t=n.split("\n"),e=/\[\d{2}:\d{2}.\d{2}\]/g,r=[];0===t[t.length-1].length&&t.pop();for(const i of t)if(e.exec(i)){const n=i.indexOf("]"),t=i.substring(0,n+1),e=i.substring(n+1),l=t.substring(1,t.length-2),a=l.split(":");r.push([60*parseInt(a[0],10)+parseFloat(a[1]),e])}return r.sort((n,t)=>n[0]-t[0]),r}(t)}ngOnDestroy(){}};h=i.a([Object(c.a)(),i.b("design:paramtypes",[l.a])],h);class u{}var o=e("fYis"),p=e("vk2e"),f=[[".lyric-wrapper[_ngcontent-%COMP%]{position:absolute;width:650px;height:65%;top:100px;left:50%;-webkit-transform:translateX(-325px);transform:translateX(-325px);overflow:hidden;z-index:10}.lyric-wrapper[_ngcontent-%COMP%]   .lyric-inner[_ngcontent-%COMP%]{transition:top .3s ease-out;-webkit-transform-origin:0 0 0;transform-origin:0 0 0;position:absolute;left:10px;right:10px;top:280px}.lyric-wrapper[_ngcontent-%COMP%]   .lyric-inner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{overflow:hidden;height:42px;line-height:42px;text-overflow:ellipsis;white-space:nowrap;font-size:16px;color:rgba(225,225,225,.6);text-align:center;margin:0}.lyric-wrapper[_ngcontent-%COMP%]   .lyric-inner[_ngcontent-%COMP%]   p.active[_ngcontent-%COMP%]{font-size:20px;color:#fff}canvas[_ngcontent-%COMP%]{position:fixed;left:0;top:0;width:100vw;height:100vh}"]],b=r.yb({encapsulation:0,styles:f,data:{}});function g(n){return r.Rb(0,[(n()(),r.Ab(0,0,null,null,4,"p",[],null,null,null,null,null)),r.Mb(512,null,p.r,p.s,[r.z,r.A,r.o,r.N]),r.zb(2,278528,null,0,p.i,[p.r],{ngClass:[0,"ngClass"]},null),r.Lb(3,{active:0}),(n()(),r.Pb(4,null,["",""]))],function(n,t){var e=t.component,r=n(t,3,0,t.context.index===e.currentIndex);n(t,2,0,r)},function(n,t){n(t,4,0,t.context.$implicit[1])})}function y(n){return r.Rb(0,[r.Nb(402653184,1,{canvasElementRef:0}),(n()(),r.Ab(1,0,null,null,3,"div",[["class","lyric-wrapper"]],null,null,null,null,null)),(n()(),r.Ab(2,0,null,null,2,"div",[["class","lyric-inner"]],[[4,"top","px"]],null,null,null,null)),(n()(),r.pb(16777216,null,null,1,null,g)),r.zb(4,278528,null,0,p.j,[r.Y,r.V,r.z],{ngForOf:[0,"ngForOf"]},null),(n()(),r.Ab(5,0,[[1,0],["canvas",1]],null,0,"canvas",[],null,null,null,null,null))],function(n,t){n(t,4,0,t.component.lyrics)},function(n,t){n(t,2,0,300-42*(t.component.currentIndex+1))})}var d=r.wb("biger-home",h,function(n){return r.Rb(0,[(n()(),r.Ab(0,0,null,null,1,"biger-home",[],null,null,null,y,b)),r.zb(1,245760,null,0,h,[l.a],null,null)],function(n,t){n(t,1,0)},null)},{},{},[]),w=e("qk26");e.d(t,"MusicModuleNgFactory",function(){return x});var x=r.xb(u,[],function(n){return r.Hb([r.Ib(512,r.l,r.kb,[[8,[o.a,d]],[3,r.l],r.F]),r.Ib(4608,p.m,p.l,[r.B,[2,p.u]]),r.Ib(1073742336,p.c,p.c,[]),r.Ib(1073742336,w.l,w.l,[[2,w.q],[2,w.k]]),r.Ib(1073742336,u,u,[]),r.Ib(1024,w.i,function(){return[[{path:"",component:h}]]},[])])})}}]);